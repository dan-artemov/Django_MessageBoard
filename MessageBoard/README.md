## ВАЖНО.
- Список используемых зависимостей по проекту приведен в requirements.txt
- Персональные параметры в settings.py (SECRET_KEY, EMAIL_HOST_USER, EMAIL_HOST_PASSWORD, DEFAULT_FROM_EMAIL, SERVER_EMAIL) вынесены в отдельный файл конфигурации.env
- Отправка писем в проекте осуществляется в консоль.
***
## Описание способа реализации задачи 
### I. Система регистрации пользователей
#### По условию задачи:
* Пользователи ресурса должны иметь возможность зарегистрироваться в нем по е-мэйл, получив письмо с кодом подтверждения регистрации. 
* После регистрации им становится доступно создание и редактирование объявлений.
#### Реализация ТЗ обеспечивается за счет предоставления пользователям соответствующих прав, после подтверждения кода, отправленного на email, для этого: 
 
   - Создано независимое приложение accounts, в рамках которого встроенная модель User расширена с помощью класса VerifyUser дополнительным полем code посредством связи OneToOneField.
   - В качестве основы для регистрации был использован пакет django-allauth, модифицированный под условия задачи.
   - В частности в settings выставлены флаги ACCOUNT_AUTHENTICATION_METHOD = 'email' и ACCOUNT_EMAIL_VERIFICATION = 'none'
   - В utils.py реализован метод  code_generator(), генерирующий 4-х символьный код.
   - Последовательность регистрации следующая:
     - пользователь вводит регистрационные данные (email и password); 
     - после успешного ввода через форму CustomSignupForm инициируется вызов метода code_generator;
     - затем передача сгенерированного кода в модель VerifyUser; 
     - инициируется отправка (через sendmail) сообщения о необходимости завершить регистрацию с указанием ссылки для завершения регистрации;
     - после перехода пользователя по ссылке открывается форма для ввода кода подтверждения, 
     - в случае успешности ввода, пользователь наследует права группы "authorized_users" и ему становятся доступны действия с объявлениями и откликами.
### II. Концепция реализации объявлений.
#### По условию задачи:
* Объявления состоят из заголовка и текста, внутри которого могут быть картинки, встроенные видео и другой контент. *
* Кроме того пользователь обязательно должен определить объявление в одну из следующих категорий: Танки, Хилы, ДД, Торговцы, Гилдмастеры, Квестгиверы, Кузнецы, Кожевники, Зельевары, Мастера заклинаний.
#### Реализация ТЗ
  - Реализация ТЗ осуществлена посредством создания, модели Message 
    - Модель Message описывает сущность Объявления и содержит следующие поля:
      - message_header: заголовок объявления;
      - message_text: Текстовое содержимое объявления;
      - data_create: Дата создания объявления;
      - category: категория объявления, принимает значения, перечисленные в кортеже VARIETY;
      - files: файл, прикрепляемый автором к Объявлению;
      - photo: изображение, прикрепляемое автором к Объявлению;
      - message_user: связь «один ко многим» со встроенной моделью User.
    - Модель содержит следующие методы и свойства:
      - preview: превью отклика, включающее дату, статус и содержание отклика;
      - get_absolute_url: генерирует прямую ссылку на объявление.
### II. Концепция реализации откликов.
#### По условию задачи:    
- Пользователи могут отправлять отклики на объявления других пользователей, состоящего из простого текста.
#### Реализация ТЗ
- Модель Comment позволяет оставлять отклики под каждым Объявлением.
  - Модель имеет следующие поля:
    - comment_message: связь «один ко многим» с моделью Message;
    - user: связь «один ко многим» со встроенной моделью User;
    - comment: содержание отклика;
    - data_create: дата и время создания отклика;
    - comment_status: принимает три значения, перечисленные в кортеже STATUS.
  - Модель содержит следующие методы и свойства:
    - accept_the_comment: позволяет принять отклик;
    - reject_the_comment: позволяет отклонить отклик;
    - preview: превью отклика, включающее дату, статус и содержание отклика;
    - get_absolute_url: генерирует прямую ссылку на объявление, для которого создан отклик.
### III. Реализации взаимоотношений между моделями Объявлений и Откликов.
#### По условию задачи:    
* При отправке отклика пользователь должен получить е-мэйл с оповещением о нем.
* При принятии отклика пользователю, оставившему отклик, также должно прийти уведомление
#### Реализация ТЗ
- Реализация уведомления автора о новом отклике на его объявление построена на сигнале "comment_created()", который инициирует отправку соответствующего сообщения на почту автора объявления, после сохранения в модели Comment нового отклика.
- Реализация уведомления пользователя, оставившего отклик достигается за счет пользовательского view "change_status", в которое передается ряд параметров, позволяющих однозначно идентифицировать пользователя, id Отклика и id ОБъявления
- Вызов вышеуказанного View осуществляется через шаблон профиля пользователя "profile. html" по нажатию пользователем соответствующей кнопки (принять или отклонить)
- После чего автору Отклика направляется посредством send_mail() уведомление о принятии, либо отклонении отклика.

#### По условию задачи:
* Также пользователю должна быть доступна приватная страница с откликами на его объявления, внутри которой он может фильтровать отклики по объявлениям, удалять их и принимать
#### Реализация ТЗ
- Реализация фильтрации обеспечивается за счет пользовательского  фильтра board/filter.py, на основе пакета 'django_filters'
- Создан фильтр CommentFilter(), использующий модель Откликов Comment
- Фильтр включает в себя три поля: 
  - status = ChoiceFilter - обеспечивает фильтрацию по статусу отклика (Принят, отклонен, не рассмотрен)
  - comment_message = ModelChoiceFilter - обеспечивает выбор Объявлений по их Заголовку
  - header = CharFilter - обеспечивает посимвольный поиск в заголовке Объявления
- Поскольку Профиль пользователя подразумевает работу только с Объявлениями, созданными пользователем, то через представление Profile реализован механизм переопределения queryset, context_data, обеспечивая передачу в фильтр только объявлений конкретного пользователя
#### По условию задачи:
* Также должна быть возможность отправки пользователям новостные рассылки.
#### Реализация ТЗ
- Реализация новостных рассылок построена на пакете периодического (раз в неделю) выполнения задач в стиле cron 'django_apscheduler'. 
- Рассылка является таргетированной и рассылается только тем пользователям, которые ранее оставили отклик в соответствующей категории. 
- Подробности реализации отражены runapscheduler.py/my_job().
- Рассылка содержит ссылки на Объявления, авторов, категории, а также превью содержания объявления
***

- 

```python

 


